## TODO
- use cpp to speedup loops 